# Data Model: AI Agent Layer with OpenRouter & FastAPI

## Entities

### User Query
- **Description**: Text input from the user that requires an answer based on documentation
- **Fields**:
  - query_text: string (the actual query from the user)
- **Validation**: Must be non-empty string

### Retrieved Context
- **Description**: Relevant text chunks retrieved from the documentation database based on the user query
- **Fields**:
  - text_content: string (the actual text content)
  - relevance_score: float (similarity score between query and chunk)
  - source_url: string (URL where the original content is located)
  - chapter_title: string (title of the chapter where content originated)
- **Validation**: relevance_score must be between 0 and 1

### AI Response
- **Description**: Natural language answer generated by the AI model based on the combined prompt
- **Fields**:
  - answer_text: string (the AI-generated response)
  - confidence_level: string (confidence indicator: high, medium, low, unknown)
  - sources: List[object] (list of source objects used to generate the answer)
- **Validation**: answer_text must be non-empty when confidence is not 'unknown'

### API Request
- **Description**: HTTP request containing the user query sent to the `/ask` endpoint
- **Fields**:
  - query: string (the user's question)
- **Validation**: query must be non-empty string

### API Response
- **Description**: JSON response containing the AI-generated answer and metadata
- **Fields**:
  - answer: string (the AI-generated answer)
  - sources: List[object] (list of source objects used to generate the answer)
- **Validation**: answer must be non-empty string or indicate "I don't know"

## Relationships

- One API Request → One AI Response (one-to-one mapping)
- One User Query → Many Retrieved Context chunks (via similarity search)
- Many Retrieved Context + User Query → One AI Response (RAG combination)

## State Transitions

1. User submits API Request with query
2. System processes query to retrieve relevant context
3. AI combines context and query to generate response
4. System returns API Response with answer and sources